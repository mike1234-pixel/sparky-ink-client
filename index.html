<!-- @format -->

<!DOCTYPE html>
<html>
  <head>
    <title>L09 - Image and curved image primitives</title>
    <!-- aframe v 1 -->
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <!-- physics package - aframe-extras && aframe-physics-system -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
    <!-- event-set component -->
    <script src="https://unpkg.com/aframe-event-set-component@5.0.0/dist/aframe-event-set-component.min.js"></script>
    <script>
      AFRAME.registerComponent("refresh-obj", {
        init: function () {
          this.el.addEventListener("click", function () {
            var myGBcursor = document.querySelector("#myGBcursor");
            myGBcursor.components.raycaster.refreshObjects();
          });
        },
      });
    </script>
  </head>
  <body>
    <a-scene
      physics="gravity: -9.8; restitution: 0.7;"
      renderer="antialias: true"
      stats
      touch-to-click-converter
    >
      <a-assets>
        <img id="floor" src="assets/marble-floor.jpg" />
        <img id="floor-NRM" src="assets/marble-floor-NRM.jpg" />
        <img id="sky" src="assets/sky.jpg" />
        <!-- 3d models -->
        <!-- <a-asset-item id="scene" src="assets/3d-models/scene.gltf"></a-asset-item>
        <a-asset-item id="globe" src="assets/3d-models/globe/scene.gltf"></a-asset-item> -->
        <!-- <a-asset-item id="warehouse" src="assets/3d-models/warehouse/scene.gltf"></a-asset-item> -->
        <!-- video -->
        <video
          id="winter-scene"
          autoplay
          loop="true"
          src="assets/video.mp4"
        ></video>
      </a-assets>

      <!-- camera and cursor -->
      <a-camera>
        <a-entity
          cursor="fuse: true; fuseTimeout: 1000"
          position="0 0 -1"
          geometry="primitive: sphere; radius: 0.005"
          material="color: #000000; shader: flat; opacity: 0.5"
          animation__enter="property: scale;
                                        to: 3 3 3;
                                        dur: 1000;
                                        easing: linear;
                                        startEvents: mouseenter"
          event-set__reset="_event: animationcomplete__enter; scale: 1 1 1"
          animation__leave="property: scale;
                                        to: 1 1 1;
                                        dur: 1000;
                                        easing: linear;
                                        startEvents: mouseleave"
          raycaster="objects: .clickable"
        >
        </a-entity>
      </a-camera>

      <!-- video -->
      <a-entity
        class="clickable"
        event-set__click="_event: click; material.color: blue"
        event-set__clearclass="_event: click; class: not-clickable"
        material="shader: flat; side: double; src: #winter-scene"
        geometry="primitive: cylinder; radius: 5; height: 3.6815; open-ended: true; theta-start: 142.5; theta-length: 75"
        position="0.4 1.5 0"
        rotation="0 270 0"
        scale="-1 1 1"
        refreshObj
      ></a-entity>

      <!-- 3d models -->

      <!-- <a-entity gltf-model="#scene" position="-10 0.01 5" scale="0.015 0.015 0.015" modify-materials></a-entity>
      <a-entity gltf-model="#globe" position="-10 0.01 5" scale="5 5 5"></a-entity> -->
      <!-- <a-entity gltf-model="#warehouse" position="-10 8.3 5" scale="10 10 10" modify-materials></a-entity> -->

      <!-- Sky -->
      <!-- rotation component aligns the sun in the sky img with the light source -->
      <a-sky src="#sky" rotation="0 64 0"> </a-sky>
      <!-- Ground | Circular -->
      <!-- remove the geometry comoponent for rectangular floor -->
      <a-plane
        material="color: #FFFFFF;
            src: #floor;
            repeat: 5 5;
            normal-map: #floor-NRM;
            normal-texture-repeat: 5 5;
            roughness: 0.7;"
        geometry="primitive: circle; radius: 1"
        rotation="-90 0 0"
        scale="10 10 1"
        static-body
      >
      </a-plane>
    </a-scene>
  </body>
</html>
